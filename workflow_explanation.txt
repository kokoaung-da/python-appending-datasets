ðŸ“‚ Data Combining Tool

This project provides a Python-based solution for combining a large number of Excel and CSV datasets into a single, consistent dataset.

I created this script because Excel Power Query struggles when working with 10,000+ files or datasets exceeding millions of rows. With this tool, you can:

âœ… Combine thousands of Excel/CSV files efficiently.

âœ… Automatically capture file directory name and file name for each record (to trace data sources).

âœ… Handle datasets larger than 10 million rows by splitting into multiple output files (500,000 rows each).

âœ… Detect and log:

âš ï¸ Mismatched files (wrong/missing columns).

âŒ Failed files (unreadable or broken files).

ðŸš€ Features

Large-scale dataset combining

Works with both .xlsx and .csv files.

Handles more than 10 million rows by splitting the final dataset into multiple Excel files, each with 500,000 rows.

Column normalization

Standardizes column headers to match a predefined schema.

If headers differ but column count matches, it renames by position.

Otherwise, the file is flagged as mismatched.

Source tracking

Every record includes two extra fields:

source_directory â†’ The folder path of the file.

source_filename â†’ The file name.

This lets you trace back where each record originated.

Error handling & reporting

Mismatched Files Report â†’ Excel file listing files that donâ€™t match the expected schema (with missing/extra columns).

Failed Files Report â†’ Excel file listing files that couldnâ€™t be read (with error reason).

Consistent processing

Files are processed in sorted order to ensure repeatable results.

Empty rows are skipped automatically.

ðŸ“Š Workflow

Collect all files under the input folder (Excel & CSV).

Normalize column headers â†’ align with the standard schema.

Combine data from all valid files.

Split into multiple Excel files if row count > 500,000.

Generate reports:

mismatched_files_report.xlsx

failed_files.xlsx

ðŸ“ Output Files

all_combined_data.xlsx (if â‰¤ 500,000 rows)

all_combined_data_1.xlsx, all_combined_data_2.xlsx, ... (if > 500,000 rows)

mismatched_files_report.xlsx

failed_files.xlsx

âš™ï¸ Configuration

At the top of the script, update these paths:

# Input folder containing all datasets
folder_path = r"D:\...\data\cleaningData\...\á€›á€”á€ºá€€á€¯á€”á€º"

# Output folder for combined data and reports
output_dir = r"D:\...\data\sampleCombinedData\ygn_combined_data"

ðŸ“‹ Example Use Case

Imagine you have 12,000 Excel files with payroll contributions, each with slightly different formatting.

With this script, you can:

Merge all files into one dataset.

Know exactly which file and folder each record came from.

Split into manageable chunks for further analysis in Power BI, SQL, or Excel.

Review logs to see which files failed or had schema mismatches.

ðŸ” Process Summary Example
--- ðŸ“Š Process Summary ---
âœ… Successfully combined files: 9,820
âš ï¸ Files with mismatched columns: 185
âŒ Failed to read files: 12
ðŸ“ Combined data saved to: D:\...\all_combined_data_1.xlsx, all_combined_data_2.xlsx, ...
âš ï¸ Mismatched report saved to: D:\...\mismatched_files_report.xlsx
âŒ Failure report saved to: D:\...\failed_files.xlsx
--- Process Complete ---

ðŸ› ï¸ Requirements

Python 3.8+

Libraries:

pip install pandas openpyxl

ðŸŒŸ Why This Project?

Excel Power Query Limitations â†’ Slow or crashes when dealing with >10,000 datasets.

Data Source Transparency â†’ Knowing the exact source file is critical for auditing.

Scalability â†’ Handles millions of rows gracefully with splitting logic.

Reliability â†’ Provides reports to catch schema issues or failed files.
